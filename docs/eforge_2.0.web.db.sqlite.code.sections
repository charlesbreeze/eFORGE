PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE assembly (
       assembly_id INTEGER PRIMARY KEY AUTOINCREMENT, 
       species_name UNIQUE, 
       assembly_name UNIQUE);
CREATE TABLE array (
       array_id INTEGER PRIMARY KEY AUTOINCREMENT,
       array_tag UNIQUE,
       array_name UNIQUE,
       species_name);
CREATE TABLE probe_mapping_info (
       probe_mapping_id INTEGER PRIMARY KEY AUTOINCREMENT,
       array_id INTEGER NOT NULL REFERENCES array(array_id),
       assembly_id INTEGER NOT NULL REFERENCES assembly(assembly_id),
       url,
       UNIQUE(array_id, assembly_id));
CREATE TABLE probe_mapping (
       probe_mapping_id INTEGER NOT NULL REFERENCES probe_mapping_info(probe_mapping_id),
       probe_id,
       chr_name,
       position INTEGER,
       UNIQUE (probe_mapping_id, probe_id));
CREATE TABLE proxy_filter_info (
       array_id INTEGER NOT NULL REFERENCES array(array_id),
       description,
       UNIQUE(array_id));
CREATE TABLE proxy_filter (
       proxy_filter_id INTEGER NOT NULL REFERENCES proxy_filter_info(proxy_filter_id),
       probe_id,
       proxy_probes,
       UNIQUE (proxy_filter_id, probe_id));
CREATE TABLE probe_annotation_info (
       array_id INTEGER NOT NULL REFERENCES array(array_id),
       gene_reference_name NOT NULL,
       cgi_reference_name NOT NULL,
       url,
       UNIQUE(array_id));
CREATE TABLE probe_annotation (
       array_id INTEGER NOT NULL REFERENCES probe_annotation_info(array_id),
       probe_id NOT NULL,
       gene_group,
       cgi_group,
       UNIQUE (array_id, probe_id));
CREATE TABLE dataset (
       dataset_id INTEGER PRIMARY KEY AUTOINCREMENT,
       dataset_tag UNIQUE,
       dataset_name UNIQUE,
       species_name);
CREATE TABLE sample (
       dataset_id INTEGER REFERENCES dataset(dataset_id),
       sample_order INTEGER,
       file,
       lab,
       datatype,
       cell,
       tissue,
       shortcell,
       individual,
       acc,
       url);
CREATE TABLE probe_bitstring (
       array_id INTEGER NOT NULL REFERENCES array(array_id),
       probe_id INTEGER NOT NULL,
       dataset_id INTEGER NOT NULL REFERENCES dataset(dataset_id),
       sum INTEGER,
       bit,
       UNIQUE(array_id,probe_id,dataset_id));


INSERT INTO assembly VALUES(1,'Homo sapiens','GRCh37');
INSERT INTO array VALUES(1,'850k','Illumina Human 850k array','Homo sapiens');
INSERT INTO probe_mapping_info VALUES(1,1,1,NULL);
INSERT INTO probe_mapping VALUES(1,'cg14817997','chr1',10524);

... repeat for all probes

INSERT INTO proxy_filter_info VALUES(1,'Distance-based: 1kb');
INSERT INTO proxy_filter VALUES(1,'cg14817997','cg16269199|cg26928153');

... repeat for all probes

INSERT INTO probe_annotation_info VALUES(1,'RefSeq','UCSC CpG Islands',NULL);
INSERT INTO probe_annotation VALUES(1,'cg07881041','Body','Shelf_Shore');

... repeat for all probes

INSERT INTO dataset VALUES(1,'erc','Roadmap Epigenomics (2012 data) - DHS','Homo sapiens');
INSERT INTO dataset VALUES(2,'encode','ENCODE - DHS','Homo sapiens');
INSERT INTO dataset VALUES(3,'erc2-DHS','Consolidated Roadmap Epigenomics - DHS','Homo sapiens');
INSERT INTO dataset VALUES(4,'erc2-H3K27me3','Consolidated Roadmap Epigenomics - H3K27me3','Homo sapiens');
INSERT INTO dataset VALUES(5,'erc2-H3K36me3','Consolidated Roadmap Epigenomics - H3K36me3','Homo sapiens');
INSERT INTO dataset VALUES(6,'erc2-H3K4me3','Consolidated Roadmap Epigenomics - H3K4me3','Homo sapiens');
INSERT INTO dataset VALUES(7,'erc2-H3K9me3','Consolidated Roadmap Epigenomics - H3K9me3','Homo sapiens');
INSERT INTO dataset VALUES(8,'erc2-H3K4me1','Consolidated Roadmap Epigenomics - H3K4me1','Homo sapiens');
INSERT INTO dataset VALUES(9,'erc2-H3-all','Consolidated Roadmap Epigenomics - All H3 marks','Homo sapiens');
INSERT INTO dataset VALUES(10,'blueprint','Blueprint - DHS','Homo sapiens');
INSERT INTO dataset VALUES(11,'erc2-chromatin15state-all','Consolidated Roadmap Epigenomics - All chromatin 15-state marks','Homo sapiens');
       dataset_id INTEGER REFERENCES dataset(dataset_id),
       dataset_id INTEGER NOT NULL REFERENCES dataset(dataset_id),
       UNIQUE(array_id,probe_id,dataset_id));
INSERT INTO sqlite_sequence VALUES('dataset',11);

INSERT INTO sample VALUES(1,1,'UW.Breast_vHMEC.ChromatinAccessibility.RM035.DS18406.twopass.merge150.wgt10.zgt2.wig.gz','UW','DHS','Breast_vHMEC.RM035','Breast','Breast_vHMEC','RM035','GSM753973','ftp://ftp.ebi.ac.uk/pub/databases/ensembl/encode/ERC_hotspots/UW.Breast_vHMEC.ChromatinAccessibility.RM035.DS18406.twopass.merge150.wgt10.zgt2.wig.gz');

... repeat for all samples

INSERT INTO probe_bitstring VALUES(1,'cg14817997',1,153,'01100000110010011011011001110000011000000000010010110010001011010111001001001101000011001011111111000001101111111011010111011111111101101101111111111110011110101101111110111011111111110010001001111000100010111001111000010101100100001010000000000000000010011000011101010000100111111011101110000000000');

... repeat for all probes

DELETE FROM sqlite_sequence;
INSERT INTO sqlite_sequence VALUES('assembly',1);
INSERT INTO sqlite_sequence VALUES('array',1);
INSERT INTO sqlite_sequence VALUES('probe_mapping_info',1);
INSERT INTO sqlite_sequence VALUES('dataset',11);
CREATE INDEX probe_mapping_idx1 on probe_mapping (position, chr_name);
COMMIT;




